#!/usr/bin/env node

const argv = require('yargs')
  .env('PLUGIN')
  .usage('$0', 'Lint a buildkite plugin')
  .option('name', {
    describe: 'Name of the plugin',
    type: 'string'
  })
  .option('path', {
    describe: 'Path to the plugin',
    type: 'string'
  })
  .option('readme', {
    describe: 'Readme filename',
    type: 'string',
    default: 'README.md'
  })
  .demandOption(['name', 'path'])
  .help()
  .version(false)
  .argv

const valid = true;

valid = valid && require('../lib/linters/lint-plugin-yaml')(argv.name, argv.path, argv)
valid = valid && require('../lib/linters/lint-examples')(argv.name, argv.path, argv)

if (!valid) {
  process.exit(1)
}